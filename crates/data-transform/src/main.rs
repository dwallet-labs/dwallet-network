// Copyright (c) Mysten Labs, Inc.
// SPDX-License-Identifier: BSD-3-Clause-Clear

use anyhow::anyhow;
use data_transform::*;
use diesel::prelude::*;
use diesel::RunQueryDsl;
use once_cell::sync::Lazy;
use std::process::exit;
use std::str::FromStr;
use std::sync::Arc;

use move_bytecode_utils::module_cache::SyncModuleCache;
use move_core_types::annotated_value::MoveStruct;
use sui_types::object::MoveObject;

use self::models::*;
use std::env;
use sui_indexer::errors::IndexerError;
use sui_indexer::new_pg_connection_pool;
use sui_indexer::store::module_resolver::IndexerModuleResolver;

use move_core_types::language_storage::ModuleId;
use move_core_types::resolver::ModuleResolver;
use std::collections::{HashMap, HashSet};
use sui_json_rpc_types::SuiMoveStruct;
use sui_types::parse_sui_struct_tag;

use tracing::debug;
extern crate base64;
use base64::engine::general_purpose::STANDARD as BASE64;
use base64::engine::Engine as _;
use move_core_types::account_address::AccountAddress;

struct GrootModuleResolver {
    module_map: HashMap<String, Vec<u8>>,
    original: IndexerModuleResolver,
}

impl GrootModuleResolver {
    fn new(blocking_cp: PgConnectionPool) -> Self {
        let original = IndexerModuleResolver::new(blocking_cp);
        let mut module_map: HashMap<String, Vec<u8>> = HashMap::new();
        let  clob = "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AQMBAwMHCwkBCAULDgEJAAMDCw4BCQADBggEBwgEAwYLDAEDAwMIEgsOAQkBAQMDCw4BCQEDBwgFAxsBAwEDAwcLCQEIBQsOAQkAAwMLDgEJAQMGCAQHCAQDAwYLDAEDAwMIEgsOAQkBAQMDCw4BCQEDBwgFAwMLDgEJAAsOAQkBCw4BCQECBwsQAQkACxABCQAHAwcLCQEIBQgEAwMDCBIDBwsLAQkABggKAwMHCwkBCQADCQADBwsRAgkACQEJAAkBAQsBAgkACQECBgsVAgkACQEJAAMHCxUCCQAJAQkACQELCw4BCQALDgEJAAsOAQkAAwMLDgEJAQsOAQkBCw4BCQEDAwgSAgYLCwEJAAgSAQsCAgkACQEBCwMCCQAJAQsDAwYLCQEIBQcLCQEIBQMBCAQDAwgSBwsRAgMDAwMHCAUIBA0DBwsJAQgFAwMBBwsJAQgFCAQDAwgSAwgSBwsRAgMDEQMDBgsJAQgFBwsJAQgFAwMBAwMDCAQDCBIDAwgSBwsRAgMDBwYIBQoIBAYIBAYLDAEDAwgSBgsRAgMDBQMDAwMIEgYDCgMDAwMKAwQDBggEBgsMAQMGCxECAwgEBAYLCQEIBQMIEgYLEQIDAwpBY2NvdW50Q2FwB0JhbGFuY2UFQ2xvY2sEQ29pbgtDcml0Yml0VHJlZQlDdXN0b2RpYW4CSUQLTGlua2VkVGFibGUGT3B0aW9uBU9yZGVyDU9yZGVyQ2FuY2VsZWQLT3JkZXJGaWxsZWQNT3JkZXJGaWxsZWRWMgtPcmRlclBsYWNlZA1PcmRlclBsYWNlZFYyBFBvb2wLUG9vbENyZWF0ZWQDU1VJBVRhYmxlCVRpY2tMZXZlbAlUeENvbnRleHQIVHlwZU5hbWUDVUlEGWFjY291bnRfYXZhaWxhYmxlX2JhbGFuY2UPYWNjb3VudF9iYWxhbmNlA2FkZARhc2tzBGJhY2sHYmFsYW5jZQpiYXNlX2Fzc2V0HGJhc2VfYXNzZXRfcXVhbnRpdHlfY2FuY2VsZWQaYmFzZV9hc3NldF9xdWFudGl0eV9maWxsZWQaYmFzZV9hc3NldF9xdWFudGl0eV9wbGFjZWQdYmFzZV9hc3NldF9xdWFudGl0eV9yZW1haW5pbmcXYmFzZV9hc3NldF90cmFkaW5nX2ZlZXMOYmFzZV9jdXN0b2RpYW4SYmF0Y2hfY2FuY2VsX29yZGVyBGJpZHMGYm9ycm93FGJvcnJvd19sZWFmX2J5X2luZGV4EmJvcnJvd19sZWFmX2J5X2tleQpib3Jyb3dfbXV0GGJvcnJvd19tdXRfbGVhZl9ieV9pbmRleBFjYW5jZWxfYWxsX29yZGVycwxjYW5jZWxfb3JkZXIEY2xvYgVjbG9jawRjb2luCGNvbnRhaW5zDmNyZWF0ZV9hY2NvdW50C2NyZWF0ZV9wb29sDGNyZWF0ZV9wb29sXwxjcmVhdGlvbl9mZWUHY3JpdGJpdAljdXN0b2RpYW4fZGVjcmVhc2VfdXNlcl9hdmFpbGFibGVfYmFsYW5jZRxkZWNyZWFzZV91c2VyX2xvY2tlZF9iYWxhbmNlDGRlcG9zaXRfYmFzZQ1kZXBvc2l0X3F1b3RlDWRlc3Ryb3lfZW1wdHkTZGVzdHJveV9lbXB0eV9sZXZlbARlbWl0E2VtaXRfb3JkZXJfY2FuY2VsZWQRZW1pdF9vcmRlcl9maWxsZWQFZXZlbnQQZXhwaXJlX3RpbWVzdGFtcBBmaW5kX2Nsb3Nlc3Rfa2V5CWZpbmRfbGVhZgxmcm9tX2JhbGFuY2UFZnJvbnQDZ2V0FmdldF9sZXZlbDJfYm9va19zdGF0dXMfZ2V0X2xldmVsMl9ib29rX3N0YXR1c19hc2tfc2lkZR9nZXRfbGV2ZWwyX2Jvb2tfc3RhdHVzX2JpZF9zaWRlEGdldF9tYXJrZXRfcHJpY2UQZ2V0X29yZGVyX3N0YXR1cwJpZB9pbmNyZWFzZV91c2VyX2F2YWlsYWJsZV9iYWxhbmNlEmluamVjdF9saW1pdF9vcmRlcgtpbnNlcnRfbGVhZgxpbnRvX2JhbGFuY2UGaXNfYmlkCGlzX2VtcHR5B2lzX25vbmUEam9pbgxsaW5rZWRfdGFibGUQbGlzdF9vcGVuX29yZGVycwxsb2NrX2JhbGFuY2UIbG90X3NpemURbWFrZXJfcmViYXRlX3JhdGUNbWFrZXJfcmViYXRlcwltYXRjaF9hc2sJbWF0Y2hfYmlkHW1hdGNoX2JpZF93aXRoX3F1b3RlX3F1YW50aXR5BG1hdGgIbWF4X2xlYWYIbWluX2xlYWYDbXVsA25ldwRuZXh0EW5leHRfYXNrX29yZGVyX2lkEW5leHRfYmlkX29yZGVyX2lkCW5leHRfbGVhZgZvYmplY3QLb3Blbl9vcmRlcnMGb3B0aW9uCG9yZGVyX2lkDG9yZGVyX2lzX2JpZAVvd25lchFwbGFjZV9saW1pdF9vcmRlchJwbGFjZV9tYXJrZXRfb3JkZXIHcG9vbF9pZA1wcmV2aW91c19sZWFmBXByaWNlCXB1c2hfYmFjawhxdWFudGl0eQtxdW90ZV9hc3NldBhxdW90ZV9hc3NldF90cmFkaW5nX2ZlZXMPcXVvdGVfY3VzdG9kaWFuBnJlbW92ZRRyZW1vdmVfbGVhZl9ieV9pbmRleAxyZW1vdmVfb3JkZXIMc2hhcmVfb2JqZWN0BXNwbGl0A3N1aRlzd2FwX2V4YWN0X2Jhc2VfZm9yX3F1b3RlGXN3YXBfZXhhY3RfcXVvdGVfZm9yX2Jhc2UFdGFibGUQdGFrZXJfY29tbWlzc2lvbg50YWtlcl9mZWVfcmF0ZQl0aWNrX3NpemUMdGltZXN0YW1wX21zDnRvdGFsX3F1YW50aXR5CHRyYW5zZmVyCnR4X2NvbnRleHQJdHlwZV9uYW1lDHVpZF9hc19pbm5lcg51bmxvY2tfYmFsYW5jZQp1bnNhZmVfZGl2CnVuc2FmZV9tdWwQdW5zYWZlX211bF9yb3VuZA91c3Jfb3Blbl9vcmRlcnMFdmFsdWUOd2l0aGRyYXdfYXNzZXQNd2l0aGRyYXdfYmFzZQ53aXRoZHJhd19xdW90ZQR6ZXJvAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3ukAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAwgAAAAAAAAAAAMIAQAAAAAAAAADCAIAAAAAAAAAAwgDAAAAAAAAAAMIBAAAAAAAAAADCAUAAAAAAAAAAwgGAAAAAAAAAAMIBwAAAAAAAAADCAgAAAAAAAAAAwgJAAAAAAAAAAMICgAAAAAAAAADCAsAAAAAAAAAAwgMAAAAAAAAAAMIDQAAAAAAAAADCA4AAAAAAAAAAwgPAAAAAAAAAAMIEAAAAAAAAAADCBEAAAAAAAAAAwgSAAAAAAAAAAMIEwAAAAAAAAADCBQAAAAAAAAAAwgAypo7AAAAAAIBBAIBAAIBAQIBAgIBAwMI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".as_bytes();
        match BASE64.decode(clob) {
            Ok(module) => {
                module_map.insert("clob".to_string(), module);
            }
            Err(_) => {
                println!("Invalid base64 encoding for clob");
            }
        }
        let  clob_v2 = "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AQEDAwEDAwEFAwMDBwsLAQgJCxABCQALAwIJAAkBCgsDAgkACQEDAwMLEAEJAAMGCAgHCAgDAwMGCw4BAwMDCBQLEAEJAQsQAQkBAQMDAwEDBwgJAwEGCwsBCQABCwMCCQAJAQIHCwsBCQADAQcJAAEGCxMCCQAJAQEGCw4BCQABBgkAAgYLEwIJAAkBCQABBgkBAwcLDQEJAAUDAgEDAgcLEAEJAAMCBwsQAQkACxABCQACBwsXAgkACQEJAAEHCQECBwsTAgkACQEJAAIGCwsBCQADAQYKCQABCwQCCQAJASQBAwEDAwEDAwEFAwMDBwsLAQgJCxABCQALAwIJAAkBCgsDAgkACQEDAwsQAQkAAwYICAcICAMGCw4BAwMDCBQLEAEJAQEDAwsQAQkBAwcICQMlAQMBAwMBAwMBBQMDAwcLCwEICQsQAQkACwMCCQAJAQoLAwIJAAkBAwMLEAEJAQMGCAgHCAgDAwYLDgEDAwMIFAsQAQkBAQMDCxABCQEDBwgJAwULEAEJAAsQAQkACxIBCQALEAEJAQsQAQkBAgcLEgEJAAsSAQkAAwcLEgEJAAMHCBgHAwcLCwEICQgIAwUDAwMHCw0BCQAGCAwDAwcLCwEJAAMJAAMHCxMCCQAJAQkACQEBCwECCQAJAQIGCxcCCQAJAQkAAwcLFwIJAAkBCQAJAQwLEAEJAAsQAQkACxABCQADAwMFCxABCQELEAEJAQsQAQkBAwMCBgsNAQkABQgIFAMDAQUDAwMBCwICCQAJAQ0IFAMDAwMDAwUDAQUDAwELBQIJAAkBCwMDBgsLAQgJBwsLAQgJAwEICAUDAwcLEwIDAwMDBwgJCAgWAwMDAwcLCwEICQMDAwEFAwsDAgkACQEKCwMCCQAJAQEHCwsBCAkICAMDBQgUAwcLEwIDAxoFAwMDAwMGCwsBCAkHCwsBCAkDAwEDCwMCCQAJAQoLAwIJAAkBAwEDAwMICAMFCBQDAwcLEwIDAxwBBQMDAwMDBwsLAQgJAwMDAwsDAgkACQEKCwMCCQAJAQMBAwMDAwcLCwEICQgIAwUIFAMDBwsTAgMDBwYICQoICAYICAYLDgEDAwUGCxMCAwMFAwMFAwMECw4BAwsOAQMLDgEDCw4BAwELDgEJAAYDCgMDAwMKAwQDBggIBgsOAQMGCxMCAwgIBAYLCwEICQMFBgsTAgMDCkFjY291bnRDYXARQWxsT3JkZXJzQ2FuY2VsZWQaQWxsT3JkZXJzQ2FuY2VsZWRDb21wb25lbnQHQmFsYW5jZQVDbG9jawRDb2luC0NyaXRiaXRUcmVlCUN1c3RvZGlhbgxEZXBvc2l0QXNzZXQCSUQLTGlua2VkVGFibGUGT3B0aW9uBU9yZGVyDU9yZGVyQ2FuY2VsZWQLT3JkZXJGaWxsZWQLT3JkZXJQbGFjZWQEUG9vbAtQb29sQ3JlYXRlZANTVUkFVGFibGUJVGlja0xldmVsCVR4Q29udGV4dAhUeXBlTmFtZQNVSUQNV2l0aGRyYXdBc3NldBlhY2NvdW50X2F2YWlsYWJsZV9iYWxhbmNlD2FjY291bnRfYmFsYW5jZQ1hY2NvdW50X293bmVyA2FkZARhc2tzBGJhY2sHYmFsYW5jZQpiYXNlX2Fzc2V0HGJhc2VfYXNzZXRfcXVhbnRpdHlfY2FuY2VsZWQaYmFzZV9hc3NldF9xdWFudGl0eV9maWxsZWQaYmFzZV9hc3NldF9xdWFudGl0eV9wbGFjZWQdYmFzZV9hc3NldF9xdWFudGl0eV9yZW1haW5pbmcXYmFzZV9hc3NldF90cmFkaW5nX2ZlZXMOYmFzZV9jdXN0b2RpYW4SYmF0Y2hfY2FuY2VsX29yZGVyBGJpZHMGYm9ycm93FGJvcnJvd19sZWFmX2J5X2luZGV4EmJvcnJvd19sZWFmX2J5X2tleQpib3Jyb3dfbXV0GGJvcnJvd19tdXRfbGVhZl9ieV9pbmRleBFjYW5jZWxfYWxsX29yZGVycwxjYW5jZWxfb3JkZXIXY2xlYW5fdXBfZXhwaXJlZF9vcmRlcnMPY2xpZW50X29yZGVyX2lkB2Nsb2JfdjIFY2xvY2sEY29pbghjb250YWlucw5jcmVhdGVfYWNjb3VudBZjcmVhdGVfY3VzdG9taXplZF9wb29sC2NyZWF0ZV9wb29sDGNyZWF0ZV9wb29sXwxjcmVhdGlvbl9mZWUHY3JpdGJpdAxjdXN0b2RpYW5fdjIfZGVjcmVhc2VfdXNlcl9hdmFpbGFibGVfYmFsYW5jZRxkZWNyZWFzZV91c2VyX2xvY2tlZF9iYWxhbmNlDGRlcG9zaXRfYmFzZQ1kZXBvc2l0X3F1b3RlDWRlc3Ryb3lfZW1wdHkTZGVzdHJveV9lbXB0eV9sZXZlbARlbWl0E2VtaXRfb3JkZXJfY2FuY2VsZWQRZW1pdF9vcmRlcl9maWxsZWQFZXZlbnQQZXhwaXJlX3RpbWVzdGFtcBBmaW5kX2Nsb3Nlc3Rfa2V5CWZpbmRfbGVhZgxmcm9tX2JhbGFuY2UFZnJvbnQDZ2V0FmdldF9sZXZlbDJfYm9va19zdGF0dXMfZ2V0X2xldmVsMl9ib29rX3N0YXR1c19hc2tfc2lkZR9nZXRfbGV2ZWwyX2Jvb2tfc3RhdHVzX2JpZF9zaWRlEGdldF9tYXJrZXRfcHJpY2UQZ2V0X29yZGVyX3N0YXR1cwJpZB9pbmNyZWFzZV91c2VyX2F2YWlsYWJsZV9iYWxhbmNlEmluamVjdF9saW1pdF9vcmRlcgtpbnNlcnRfbGVhZgxpbnRvX2JhbGFuY2UGaXNfYmlkCGlzX2VtcHR5B2lzX25vbmUEam9pbgxsaW5rZWRfdGFibGUQbGlzdF9vcGVuX29yZGVycwxsb2NrX2JhbGFuY2UIbG90X3NpemUNbWFrZXJfYWRkcmVzcxVtYWtlcl9jbGllbnRfb3JkZXJfaWQRbWFrZXJfcmViYXRlX3JhdGUNbWFrZXJfcmViYXRlcwltYXRjaF9hc2sJbWF0Y2hfYmlkHW1hdGNoX2JpZF93aXRoX3F1b3RlX3F1YW50aXR5BG1hdGgIbWF4X2xlYWYIbWluX2xlYWYQbWludF9hY2NvdW50X2NhcANtdWwDbmV3BG5leHQRbmV4dF9hc2tfb3JkZXJfaWQRbmV4dF9iaWRfb3JkZXJfaWQJbmV4dF9sZWFmBG5vbmUGb2JqZWN0C29wZW5fb3JkZXJzBm9wdGlvbghvcmRlcl9pZAxvcmRlcl9pc19iaWQPb3JkZXJzX2NhbmNlbGVkEW9yaWdpbmFsX3F1YW50aXR5BW93bmVyEXBsYWNlX2xpbWl0X29yZGVyEnBsYWNlX21hcmtldF9vcmRlcgdwb29sX2lkDXByZXZpb3VzX2xlYWYFcHJpY2UJcHVzaF9iYWNrCHF1YW50aXR5C3F1b3RlX2Fzc2V0GHF1b3RlX2Fzc2V0X3RyYWRpbmdfZmVlcw9xdW90ZV9jdXN0b2RpYW4GcmVtb3ZlFHJlbW92ZV9sZWFmX2J5X2luZGV4DHJlbW92ZV9v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".as_bytes();
        match BASE64.decode(clob_v2) {
            Ok(module) => {
                module_map.insert("clob_v2".to_string(), module);
            }
            Err(_err) => {
                println!("Invalid base64 encoding for clob_v2");
            }
        }
        let critbit = "oRzrCwYAAAAOAQAIAggcAyTCAQTmATYFnALoAQeEBKYECKoIQAbqCHgK4gkzC5UKBAyZCq0ODcYYHA7iGBQP9hgEAA4AHgEtAS4AAgYBAAAAAQYAAAAEAQQAAgMMAgcBBAEDBAIAACEAAQEEACwCAwEEABYCBAEEACACBQEEAB8CBQEEACYGBQEEACMGBQEEABsGAwEEACoGAwEEABQHAwEEABIGCAEEABEGAwEEACgJCgEEAAoJCwEEAAcGDAEEAAgGDAEEABABDQEGAA8BDQEEABMGAwEEAC8ODQEEABcPBAEEAQ0ZGgACBRgNAgcEAgYUFQIHBAIJHB4CBwQCDxENAgcEAhARDQIHBgIWEwQCBwQCHBMDAgcEAiEAEQIHBAInHB0CBwQdEB0SHBIbEgIKFxIKChQKFxAICgcKFhISChYQEwoGCgUKHhIBChgQGBIeEA4KGhAaEhkSGRABBwgEAQsCAQkAAQYLAgEJAAEDAQECAwMCBgsCAQkAAwMHCwIBCQADCQACAQMCBwsCAQkAAwEJAAEHCQABBgkAAAQHCwIBCQADAwEDBgsCAQkAAwMCAwgBAQsDAgkACQECAwsAAQkAAQYLAwIJAAkBAgYLAwIJAAkBCQABBgkBBAEDAwMQAwMDAwMCBggBAQEIAQMDCwABCQADAwMDBwsDAgkACQEJAAkBAQQBAhADAwMDAwMDAwMBAwMGCAEDAwkAAgcLAwIJAAkBCQABCQEBBwkBAgsDAgMIAQsDAgMLAAEJAAIGCAEDC0NyaXRiaXRUcmVlDEludGVybmFsTm9kZQRMZWFmBVRhYmxlCVR4Q29udGV4dANhZGQGYm9ycm93FGJvcnJvd19sZWFmX2J5X2luZGV4EmJvcnJvd19sZWFmX2J5X2tleQpib3Jyb3dfbXV0GGJvcnJvd19tdXRfbGVhZl9ieV9pbmRleARjbG9iB2Nsb2JfdjITY291bnRfbGVhZGluZ196ZXJvcwdjcml0Yml0DWRlc3Ryb3lfZW1wdHkEZHJvcBBmaW5kX2Nsb3Nlc3Rfa2V5CWZpbmRfbGVhZh1nZXRfY2xvc2VzdF9sZWFmX2luZGV4X2J5X2tleQtpbnNlcnRfbGVhZg5pbnRlcm5hbF9ub2Rlcwhpc19lbXB0eQ1pc19sZWZ0X2NoaWxkA2tleQZsZWF2ZXMKbGVmdF9jaGlsZA5sZWZ0X21vc3RfbGVhZgZsZW5ndGgEbWFzawRtYXRoCG1heF9sZWFmCG1pbl9sZWFmA25ldxhuZXh0X2ludGVybmFsX25vZGVfaW5kZXgJbmV4dF9sZWFmD25leHRfbGVhZl9pbmRleAZwYXJlbnQNcHJldmlvdXNfbGVhZgZyZW1vdmUUcmVtb3ZlX2xlYWZfYnlfaW5kZXgLcmlnaHRfY2hpbGQPcmlnaHRfbW9zdF9sZWFmBHJvb3QEc2l6ZQV0YWJsZQp0eF9jb250ZXh0DHVwZGF0ZV9jaGlsZAV2YWx1ZQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAN7pAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIDCAEAAAAAAAAAAwgCAAAAAAAAAAMIAwAAAAAAAAADCAQAAAAAAAAAAwgFAAAAAAAAAAMIBgAAAAAAAAADCAcAAAAAAAAAAwgIAAAAAAAAAAMICQAAAAAAAAADCAAAAAAAAACAAwj//////////wMI/////////38AAgMYAzAJACUDAQIEHQMaAykDJQMCAgcrAxULAwIDCAEZCwMCAwsAAQkAIAMfAyIDJAMCCgAKAAMAAA0LBwkKADgACwA4AQcJBwkGAAAAAAAAAAAGAAAAAAAAAAA5AAIBAwAADQQLADcAOAICAgMAAA0ECwA3ADgDAgMDAAANFQoAOAQgBAUFCQsAAQcEJwoANwAKADcBFDgFNwIUCwA3ARQCBAMAAA0VCgA4BCAEBQUJCwABBwQnCgA3AAoANwMUOAU3AhQLADcDFAIFAQAAFk4KAAsBOAYMAwEKAwcJIgQKBQ4LAAEHBCcHCgoDFwwFCgA3AAsDOAU3BBQMBAoEBwkiBCQFHgoACgQLBTgHDAIFJgkMAgsCBDILBAwFCgA3BQoFOAgQBhQMBAUZCgQHCSEEOwsAAQYAAAAAAAAAAAcJAgcKCgAKADcFCwQ4CBAHFDgJFwwDCwA3AAoDOAU3AhQLAwIGAwAAFk8KAAsBOAYMAwEKAwcJIgQKBQ4LAAEHBCcHCgoDFwwFCgA3AAsDOAU3BBQMBAoEBwkiBCUFHgoACgQLBTgHIAwCBScJDAILAgQzCwQMBQoANwUKBTgIEAYUDAQFGQoEBwkhBDwLAAEGAAAAAAAAAAAHCQIHCgoACgA3BQsEOAgQCBQ4ChcMAwsANwAKAzgFNwIUCwMCBwAAAAMTCwEMAgoCBwkjBA8FBwoANwULAjgIEAcUDAIFAgsAAQsCAggAAAADEwsBDAIKAgcJIwQPBQcKADcFCwI4CBAIFAwCBQILAAELAgIJAwAAF/cBCgELAgcJOQEMDwoANwYUDBAKADcGFAYBAAAAAAAAABYKADYGFQoQBwsGAQAAAAAAAAAXIwQYBRwLAAEHAScKADYAChALDzgLCgAKAQwDLgsDOAwMBwoHBwkhBEUKEAYAAAAAAAAAACEEMQU1CwABBwInBwoKEBcKADYHFQoQCgA2ARULEAsANgMVBgAAAAAAAAAAAgoANwALBzgFNwIUDAYKBgoBIgRRBVULAAEHAycxQAsGCgEdNREVMUAXFwwIBgEAAAAAAAAACwgxARcvDBEKEQcJBwkHCRIBDAwKADcIFAwNCgA3CBQGAQAAAAAAAAAWCgA2CBUKADYFCg0LDDgNCgA3BxQMEgcJDA4KEgcJIwSpAQWHAQoANwUKEjgIDAkKEQoJEAwUJASVAQsJAQWpAQsSDA4KAQoJEAwUHAYAAAAAAAAAACEEpAELCRAHFAwSBagBCwkQCBQMEgWCAQoOBwkhBLIBCg0KADYHFQXBAQoACg4KEgwFDAQuCwQLBTgHDAoKAAsOCg0LCjgOCxEKARwGAAAAAAAAAAAhDAsKAAoNBwoKEBcKCzgOCgALDQsSCwsgOA4KADcACgA3ARQ4BTcCFAoBJATjAQoQCgA2ARUKADcACgA3AxQ4BTcCFAsBIwTzAQoQCwA2AxUF9QELAAELEAIKAwAAAxsKADgEBAgLAAEJBwkCCgAKATgMDAILADcACgI4BTcCFAsBIgQYCQcJAggLAgILAwAAAxIKADgEBAcLAAEGAAAAAAAAAAACCgALATgMDAILADcACwI4BTcCFAIMAwAAG6sBCgA3AAoBOAU3AhQMDAoANwEUCgEhBBkKAAoMDAQuCwQ4DwwJAQsJCgA2ARUKADcDFAoBIQQrCgALDAwFLgsFOBAMCgELCgoANgMVCgA2AAoBOBE6AQwPDBEBCgAuOBIGAAAAAAAAAAAhBE4HCQoANgcVBwkKADYBFQcJCgA2AxUGAAAAAAAAAAAKADYIFQYAAAAAAAAAAAsANgYVBakBCg8HCSIEUwVXCwABBwYnCgA3BQoPOAgMDgoOEAYUDA0KAAoPBwoLARcMBwwGLgsGCwc4BwRxCw4QCBQMCAV1Cw4QBxQMCAsIDBAKDQcJIQSVAQoQBwkjBIcBBwkKADYFChA4Ew8GFQWQAQcJCgA2AAcKChAXOBQ2BBULEAoANgcVBaQBCgAKDQoPDAMMAi4LAgsDOAcMCwoACw0LEAsLOA4LADYFCw84FQELEQINAwAADQYLADYACwE4FDYJAg4DAAANBgsANwALATgFNwkCDwMAAAMOCgALATgGDAIEBgUKCwABBwQnCwALAjgWAhADAAAfDgsAOgABAQEBDAIMAQELATgXCwI4GAIRAwAAHxcOADcAOAIGAAAAAAAAAAAhBAcFCQYAAAAAAAAAACcLADoAAQEBAQwCDAEBCwI4GQsBOBoCEgAAACAuCgA3BxQMAwoDBwkhBAwLAAEHCQIKAwcJIwQoBREKADcFCwM4CAwCCgEKAhAMFBwGAAAAAAAAAAAhBCMLAhAHFAwDBScLAhAIFAwDBQwLAAEHCgsDFwITAAAADTAKAQcJIgQFBQkLAAEHBycLAwQTCgIKADYFCgE4Ew8HFQUaCgIKADYFCgE4Ew8IFQoCBwkkBCgLAQsANgAHCgsCFzgUNgQVBS8LAQsANgULAjgTDwYVAhQAAAANCQsANwULATgIEAcUCwIhAgICAgMAAAIEAAICAQEDAQEBAgIGAgACBQEAAAEACgEKAgoDCgQKBQoJCgoKCwoNCgALAAwA".as_bytes();
        match BASE64.decode(critbit) {
            Ok(module) => {
                module_map.insert("critbit".to_string(), module);
            }
            Err(_err) => {
                println!("Invalid base64 encoding for critbit");
            }
        }
        let custodian = "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".as_bytes();
        match BASE64.decode(custodian) {
            Ok(module) => {
                module_map.insert("custodian".to_string(), module);
            }
            Err(_err) => {
                println!("Invalid base64 encoding for custodian");
            }
        }
        let custodian_v2 = "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".as_bytes();
        match BASE64.decode(custodian_v2) {
            Ok(module) => {
                module_map.insert("custodian_v2".to_string(), module);
            }
            Err(_err) => {
                println!("Invalid base64 encoding for custodian_v2");
            }
        }
        let math = "oRzrCwYAAAAIAQACAwIoBSoUBz5+CLwBIAbcASYMggK3BQ+5BwYABQAKAAEAAAsAAgAABgABAAAHAAIAAAgAAQAACQACAAAEAAIAAAIDBAACAwMBAwIBAwEEAQIAAwEEBAICAgRjbG9iB2Nsb2JfdjITY291bnRfbGVhZGluZ196ZXJvcwdjcml0Yml0CWRpdl9yb3VuZARtYXRoA211bAltdWxfcm91bmQKdW5zYWZlX2RpdhB1bnNhZmVfZGl2X3JvdW5kCnVuc2FmZV9tdWwQdW5zYWZlX211bF9yb3VuZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAN7pAwgAypo7AAAAAAQQAMqaOwAAAAAAAAAAAAAAAAMIAQAAAAAAAAAAAwAAAQcLAAsBEQEMAgELAgIBAwAABhoLADUMAwsBNQwECAwCCgMKBBgHARkyAAAAAAAAAAAAAAAAAAAAACEEEgkMAgsCCwMLBBgHARo0AgIBAAABDgsACwERAQwCAQoCBgAAAAAAAAAAJAQKBQwHAicLAgIDAQAAAg8LAAsBEQEMAwwCCgMGAAAAAAAAAAAkBAoFDAcCJwsCCwMCBAMAAAEHCwALAREFDAIBCwICBQMAAAYcCwA1DAMLATUMBAgMAgoDBwA1GAoEGTIAAAAAAAAAAAAAAAAAAAAAIQQTCQwCCwILAwcANRgLBBo0AgYBAAACDwsACwERBQwDDAIKAwYAAAAAAAAAACQECgUMBwInCwILAwIHAwAAB2sKADIAAAAAAAAAAAAAAAAAAAAAIQQHMYAMAQVpMQAMAgoAMgAAAAAAAAAA//////////8cMgAAAAAAAAAAAAAAAAAAAAAhBBcLADFALwwACwIxQBYMAgoAMgAAAAAAAAAAAAAAAP////8cMgAAAAAAAAAAAAAAAAAAAAAhBCULADEgLwwACwIxIBYMAgoAMgAAAAAAAAAAAAAAAAAA//8cMgAAAAAAAAAAAAAAAAAAAAAhBDMLADEQLwwACwIxEBYMAgoAMgAAAAAAAAAAAAAAAAAAAP8cMgAAAAAAAAAAAAAAAAAAAAAhBEELADEILwwACwIxCBYMAgoAMgAAAAAAAAAAAAAAAAAAAPAcMgAAAAAAAAAAAAAAAAAAAAAhBE8LADEELwwACwIxBBYMAgoAMgAAAAAAAAAAAAAAAAAAAMAcMgAAAAAAAAAAAAAAAAAAAAAhBF0LADECLwwACwIxAhYMAgsAMgAAAAAAAAAAAAAAAAAAAIAcMgAAAAAAAAAAAAAAAAAAAAAhBGcLAjEBFgwCCwIMAQsBAgAAAAEAAwA=".as_bytes();
        match BASE64.decode(math) {
            Ok(module) => {
                module_map.insert("math".to_string(), module);
            }
            Err(_err) => {
                println!("Invalid base64 encoding for math");
            }
        }
        Self {
            module_map,
            original,
        }
    }
}

impl ModuleResolver for GrootModuleResolver {
    type Error = IndexerError;

    fn get_module(&self, id: &ModuleId) -> Result<Option<Vec<u8>>, Self::Error> {
        let address = id.address();
        println!("address = {}", address);
        if is_deepbook(address) {
            let module_name = id.name().to_string();
            println!("i am groot, module_name: {}", module_name);
            Ok(self.module_map.get(&module_name).cloned())
        } else {
            let mapped_address = map_typus_address(address);
            let module_id = ModuleId::new(mapped_address, id.name().to_owned());
            if &module_id != id {
                println!("remapped module from {:#?} to {:#?}", id, module_id);
            }
            self.original.get_module(&module_id)
        }
    }
}

static DEEPBOOK: Lazy<AccountAddress> = Lazy::new(|| {
    AccountAddress::from_str("0x000000000000000000000000000000000000000000000000000000000000dee9")
        .unwrap()
});

fn is_deepbook(address: &AccountAddress) -> bool {
    address == &*DEEPBOOK
}

static TYPUS_LATEST: Lazy<AccountAddress> = Lazy::new(|| {
    AccountAddress::from_str("0xec2cc88cc1ba1da7a936ece33417634e18618e6898e496a3493d8f58d97e705b")
        .unwrap()
});

static TYPUS_ADDRESS_SET: Lazy<HashSet<AccountAddress>> = Lazy::new(|| {
    let mut set = HashSet::new();
    set.insert(
        AccountAddress::from_str(
            "0xa76499eda1d37751473de5f30e106f35943ada2f6ea764861243e7f5aa5bcc97",
        )
        .unwrap(),
    );
    set.insert(
        AccountAddress::from_str(
            "0xfbdf925b067055a8a3ddac9739a56e61aea41f38345926b6034aa5645f5f7068",
        )
        .unwrap(),
    );
    set.insert(
        AccountAddress::from_str(
            "0x4db258013df88d79fde54eb0ecdec2bb1865c4585a897d7c1c9d20b6b768a71b",
        )
        .unwrap(),
    );
    set.insert(
        AccountAddress::from_str(
            "0xf84c82986dad0b89731ced890226639c8c1859f5b61f12394548c48706bcf04c",
        )
        .unwrap(),
    );
    set.insert(
        AccountAddress::from_str(
            "0xa390965beb1f120a469183ac10ccbac83e78dd7f505e9dcc803a93c7a079d9fd",
        )
        .unwrap(),
    );
    set.insert(
        AccountAddress::from_str(
            "0xf0ba0f41946081992325cbc52a73ded90aa969b868ce9f907dd60d5e7ad8698",
        )
        .unwrap(),
    );
    set.insert(
        AccountAddress::from_str(
            "0x5a8d167ae1279043c73a8a0d383c6a07f20c5dc3c1309ba560f89028447dc284",
        )
        .unwrap(),
    );
    set.insert(
        AccountAddress::from_str(
            "0xd95d83e5fdef4a5c042270e4a97e1284658bf0057f00f4989f9c13f56b7afed4",
        )
        .unwrap(),
    );
    set
});

fn map_typus_address(address: &AccountAddress) -> AccountAddress {
    if TYPUS_ADDRESS_SET.contains(address) {
        *TYPUS_LATEST
    } else {
        *address
    }
}

fn main() {
    use self::schema::events::dsl::*;
    use self::schema::events_json::dsl::*;

    // get the starting id from the arguments
    let args: Vec<String> = env::args().collect();

    if args.len() < 2 {
        eprintln!("Usage: data-transform <id>");
        exit(0);
    }

    let start_id: i64 = match args[1].parse() {
        Ok(num) => num,
        Err(_) => {
            eprintln!("Invalid integer: {}", args[1]);
            exit(0);
        }
    };

    println!("start id = {}", start_id);

    //let mut end_id: i64 = start_id +1;

    let database_url = env::var("DATABASE_URL").expect("DATABASE_URL must be set");
    let connection = &mut establish_connection();

    let blocking_cp = new_pg_connection_pool(&database_url)
        .map_err(|e| anyhow!("Unable to connect to Postgres, is it running? {e}"));
    //let module_cache = Arc::new(SyncModuleCache::new(IndexerModuleResolver::new(blocking_cp.expect("REASON").clone())));
    //
    let module_cache = Arc::new(SyncModuleCache::new(GrootModuleResolver::new(
        blocking_cp.expect("REASON"),
    )));

    for target_id in start_id.. {
        let event = events
            .find(target_id)
            .select(Event::as_select())
            .first(connection)
            .optional();

        match event {
            Ok(Some(event)) => {
                println!("-----------\n");
                println!("event id = {}", event.id);
                debug!("event sequence = {:#?}", event.event_sequence);
                debug!("sender = {:#?}", event.sender);
                println!("package = {:#?}", event.package);
                debug!("module = {:#?}", event.module);
                debug!("type = {:#?}", event.event_type);
                let text = String::from_utf8_lossy(&event.event_bcs);
                debug!("bcs in text = {:#?}", text);

                /*
                if event.package != "0x000000000000000000000000000000000000000000000000000000000000dee9" {
                    println!("not deepbook skipping...");
                    continue;
                }
                */

                // check for the previous record in events_json
                let eventj = events_json
                    .find(target_id)
                    .select(EventsJson::as_select())
                    .first(connection)
                    .optional();

                match eventj {
                    Ok(Some(_eventj)) => {
                        println!("Already processed {}, skipping...", target_id);
                        continue;
                    }
                    Ok(None) => {
                        println!("Unable to find event_json {}", target_id);
                    }
                    Err(_) => {
                        println!("An error occured while fetching event_json {}", target_id);
                    }
                }

                // JSON parsing starts here
                let type_ = parse_sui_struct_tag(&event.event_type).expect("cannot load StructTag");

                let layout = MoveObject::get_layout_from_struct_tag(type_.clone(), &module_cache);

                match layout {
                    Ok(l) => {
                        let move_object = MoveStruct::simple_deserialize(&event.event_bcs, &l)
                            .map_err(|e| IndexerError::SerdeError(e.to_string()));

                        match move_object {
                            Ok(m) => {
                                let parsed_json = SuiMoveStruct::from(m).to_json_value();
                                let final_result =
                                    serde_json::to_string_pretty(&parsed_json).unwrap();
                                println!("event json = {}", final_result);

                                let new_event_json = EventsJson {
                                    id: event.id,
                                    event_json: final_result,
                                };

                                let _inserted_event_json = diesel::insert_into(events_json)
                                    .values(&new_event_json)
                                    .execute(connection)
                                    .expect("Error saving new events json");

                                println!("Inserted new event_json id: {}", event.id);
                            }
                            Err(e) => {
                                println!("error in deserialize:{} {}", e, type_);
                                continue;
                            }
                        }
                    }
                    Err(err) => {
                        println!("error in get_layout: {} {}", err, type_);
                        continue;
                    }
                }
            }
            Ok(None) => {
                println!("error unable to find event {}", target_id);
                exit(0);
            }
            Err(_) => {
                println!("An error occured while fetching event {}", target_id);
                exit(0);
            }
        }
    }
}
